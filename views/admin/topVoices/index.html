<div class="search-voices">
</div>


<br class="-clear-after">

<div class="topvoice-container" id="pos-container">

	<div class="admin-user" id="" data-position="">
		<div class="upload-video-voices">
		</div>
		<div class="upload-image-voices">
		</div>
		<div class="video-text-voices">
		</div>
		<div class="video-url-voices">
		</div>
		<div class="video-description-voices">
		</div>
	</div>

</div>

<script>
	var headerEl = document.querySelector('header .header-actions');
	headerEl.innerHTML = '<h2>Top voice</h2>';

	// Search voice widget
	var searchInput = new CV.InputButton({
		style     : 'primary',
		placeholder : 'Search voice...',
		title     : "Add Top Voice",
		buttonLabel : "Search"
	}).render($('.search-voices'));
	searchInput.disableButton();


	// Voice video
	var voiceVideo = new CV.InputButton({
		style     : 'primary',
		placeholder : 'Upload video...',
		title     : "Add voice video",
		buttonLabel : "Search file"
	}).render($('.upload-video-voices'));
	var voiceVideoInput = voiceVideo.el.querySelector('input');

	voiceVideoInput.setAttribute('type', 'file');
	voiceVideoInput.setAttribute('hidden', 'true');
	voiceVideoInput.setAttribute('accept', 'video/*');

	voiceVideo.buttonEl.on('click', function(){ $(voiceVideoInput).click();} );
	
	$(voiceVideoInput).on('change', function(){
		var element = document.createElement('p');
		element.innerText = voiceVideoInput.files[0].name;
		var labelContainer = voiceVideo.el.querySelector('.cv-input');
		labelContainer.appendChild(element);
	});

	// Voice image
	var voiceImage = new CV.InputButton({
		style     : 'primary',
		placeholder : 'Upload image...',
		title     : "Add voice image",
		buttonLabel : "Search file"
	}).render($('.upload-image-voices'));
	var voiceImageInput = voiceImage.el.querySelector('input');

	voiceImageInput.setAttribute('type', 'file');
	voiceImageInput.setAttribute('hidden', 'true');
	voiceImageInput.setAttribute('accept', 'image/*');
	
	voiceImage.buttonEl.on('click', function(){ $(voiceImageInput).click();} );
	
	$(voiceImageInput).on('change', function(){
		var element = document.createElement('p');
		element.innerText = voiceImageInput.files[0].name;
		var labelContainer = voiceImage.el.querySelector('.cv-input');
		labelContainer.appendChild(element);
	});

	// Voice text
	var voiceText = new CV.UI.Input({
		name : 'voiceText',
        data: {
            label : 'Video source title',
            inputClassName : '-lg -block',
        }
	}).render($('.video-text-voices'));
	var inputText = voiceText.el.querySelector('input');

	// Voice url
	var voiceUrl = new CV.UI.Input({
		name : 'voiceUrl',
        data: {
            label : 'Video source url',
            inputClassName : '-lg -block',
        }
	}).render($('.video-url-voices'));
	var inputUrl = voiceUrl.el.querySelector('input');
	inputUrl.setAttribute('type', 'url');

	// Upload voice video
	var voiceDescription = new CV.UI.Input({
		style     : 'primary',
		data : {
            isTextArea : true,
            label : 'Description',
            hint : '',
            inputClassName : '-lg -block',
            attr : {
                rows : 3,
                maxlength: this.MAX_DESCRIPTION_LENGTH
            }
        }
	}).render($('.video-description-voices'));
	var descriptionInput = voiceDescription.el.querySelector('textarea');

	var submitButton = new CV.UI.Button({
		name: 'submitButton',
		className : 'primary',
		data : {
			value : 'Submit video'
		}
	}).render($('.video-description-voices'));
	
	$(submitButton.el).on('click', function(){ 

		var videoFile = voiceVideoInput.files[0];
		var imageFile = voiceImageInput.files[0];
		var sourceTitle = inputText.value;
		var sourceUrl = inputUrl.value;
		var description = descriptionInput.value;
		var data = {
		    files : {
		      	video : videoFile
		    },
		    body : {
		      	voiceId : '120',
		      	sourceText : sourceTitle,
		      	sourceUrl : sourceUrl,
		      	description : description
		    }
		};
		
		if(videoFile && imageFile && sourceTitle && sourceUrl){ 
			$.ajax({
		      type: "POST",
		      url:'/admin/topVoices',
		      headers: { 'csrf-token': $('meta[name="csrf-token"]').attr('content') },
		      processData: false,
		      data : data,
		      success: function(data){
		      	console.log(data);
		      	console.log('Nice');
		      }
		    });
		} else {
			console.log('vacio');
		}

	});

</script>
